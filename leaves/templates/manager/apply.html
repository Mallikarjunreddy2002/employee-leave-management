{% extends 'base.html' %}{% block title %}Apply My Leave{% endblock %}
{% block content %}
<div class="row justify-content-center"><div class="col-md-7">
<div class="alert alert-info"><i class="fas fa-info-circle"></i> Your leave application will be sent to <strong>Admin</strong> for approval.</div>
<div class="card shadow">
<div class="card-header bg-primary text-white"><h4 class="mb-0"><i class="fas fa-paper-plane"></i> Apply My Leave (Manager)</h4></div>
<div class="card-body">
<div class="alert alert-secondary">
<strong>Your Balance:</strong> Casual: <strong>{{ lb.casual_leave }}</strong> &bull; Sick: <strong>{{ lb.sick_leave }}</strong> &bull; Earned: <strong>{{ lb.earned_leave }}</strong> days
</div>
<form method="post">{% csrf_token %}
{% for f in form %}<div class="form-group"><label class="font-weight-bold">{{ f.label }}</label>{{ f }}{% if f.errors %}<div class="text-danger small mt-1">{{ f.errors }}</div>{% endif %}</div>{% endfor %}
{% if form.non_field_errors %}<div class="alert alert-danger">{{ form.non_field_errors }}</div>{% endif %}
<div class="form-group"><label class="font-weight-bold">Estimated Working Days</label>
<input type="text" id="dayCount" class="form-control" readonly placeholder="Select dates above..."></div>
<div class="d-flex justify-content-between">
<a href="{% url 'manager_dashboard' %}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Back</a>
<button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Submit to Admin</button>
</div></form></div></div></div></div>
{% endblock %}
{% block extra_js %}
<script>
function calcDays(){var s=new Date(document.getElementById('id_start_date').value);var e=new Date(document.getElementById('id_end_date').value);if(s&&e&&!isNaN(s)&&!isNaN(e)&&e>=s){var c=0,d=new Date(s);while(d<=e){if(d.getDay()!==0&&d.getDay()!==6)c++;d.setDate(d.getDate()+1);}document.getElementById('dayCount').value=c+' working day(s)';}}
document.getElementById('id_start_date').addEventListener('change',calcDays);
document.getElementById('id_end_date').addEventListener('change',calcDays);
</script>
{% endblock %}
